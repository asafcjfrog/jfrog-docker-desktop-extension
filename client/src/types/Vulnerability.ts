import { Severity } from './severity';

export type Vulnerability = {
  [VulnerabilityKeys.severity]: keyof Severity;
  [VulnerabilityKeys.impactedPackageName]: string;
  [VulnerabilityKeys.impactedPackageVersion]: string;
  [VulnerabilityKeys.impactedPackageType]: string;
  [VulnerabilityKeys.fixedVersions]?: string[];
  [VulnerabilityKeys.cves]?: Cve[];
  [VulnerabilityKeys.issueId]: string;
  [VulnerabilityKeys.summary]?: string;
  [VulnerabilityKeys.references]?: string[];
  [VulnerabilityKeys.impactPaths]?: Component[][];
  [VulnerabilityKeys.jfrogResearchInformation]?: JfrogResearchInformation;

  [VulnerabilityKeys.cveIds]: string[];
  [VulnerabilityKeys.cvssV3]: string[];
  [VulnerabilityKeys.cvssV2]: string[];
};

type Component = {
  name: string;
  version: string;
};

type JfrogResearchInformation = {
  [jfrogResearchInformation.summary]: string;
  [jfrogResearchInformation.details]: string;
  [jfrogResearchInformation.severity]: string;
  [jfrogResearchInformation.severityReasons]: JfrogResearchSeverityReason;
  [jfrogResearchInformation.remediation]?: string;
};

type JfrogResearchSeverityReason = {
  [jfrogResearchSeverityReason.name]: string;
  [jfrogResearchSeverityReason.description]: string;
  [jfrogResearchSeverityReason.isPositive]: boolean;
};

export type Cve = {
  id: string;
  cvssV2: string;
  cvssV3: string;
};

export enum VulnerabilityKeys {
  severity = 'severity',
  impactedPackageName = 'impactedPackageName',
  impactedPackageVersion = 'impactedPackageVersion',
  impactedPackageType = 'impactedPackageType',
  fixedVersions = 'fixedVersions',
  cves = 'cves',
  issueId = 'issueId',
  summary = 'summary',
  references = 'references',
  impactPaths = 'impactPaths',
  jfrogResearchInformation = 'jfrogResearchInformation',

  cveIds = 'cveIds',
  cvssV3 = 'cvssV3',
  cvssV2 = 'cvssV2',
}

enum jfrogResearchInformation {
  summary = 'summary',
  details = 'details',
  severity = 'severity',
  severityReasons = 'severityReasons',
  remediation = 'remediation',
}

enum jfrogResearchSeverityReason {
  name = 'name',
  description = 'description',
  isPositive = 'isPositive',
}
